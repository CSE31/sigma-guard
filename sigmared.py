from llm_guard import scan_prompt, scan_output
from llm_guard.input_scanners import PromptInjection, Sentiment, Toxicity,  Gibberish
import llm_guard.output_scanners as output_scanners
from llm_guard.vault import Vault
from llm_guard.input_scanners.prompt_injection import MODEL_LAIYER as PROMPT_INJECTION_MODEL
from llm_guard.input_scanners.anonymize_helpers import DEBERTA_AI4PRIVACY_v2_CONF




def generate_in_metrics(prompt):
    input_scanners = [
        Toxicity(),
        Gibberish(),
        PromptInjection(),
        Sentiment()
    ]
    sanitized_prompt, results_valid, results_score, results_arr = scan_prompt(
        input_scanners,
        prompt,
    )
    return sanitized_prompt, results_valid, results_score, results_arr
'''
Output of generate_in_metrics("I am a happy person.")
I am a happy person. {'Toxicity': True, 'Gibberish': True, 'PromptInjection': True, 'Sentiment': True} {'Toxicity': 0.0, 'Gibberish': 0.0, 'PromptInjection': 0.0, 'Sentiment': 0.0} [[[{'label': 'toxicity', 'score': 0.00036709525738842785}, {'label': 'male', 'score': 0.00016944888920988888}, {'label': 'female', 'score': 0.0001320019509876147}, {'label': 'christian', 'score': 0.00011156262917211279}, {'label': 'insult', 'score': 0.00011000069935107604}, {'label': 'psychiatric_or_mental_illness', 'score': 0.00010645322618074715}, {'label': 'muslim', 'score': 6.429268250940368e-05}, {'label': 'white', 'score': 4.482348231249489e-05}, {'label': 'jewish', 'score': 3.88558219128754e-05}, {'label': 'black', 'score': 3.078129157074727e-05}, {'label': 'homosexual_gay_or_lesbian', 'score': 2.9541197363869287e-05}, {'label': 'identity_attack', 'score': 2.946523454738781e-05}, {'label': 'threat', 'score': 2.88345599983586e-05}, {'label': 'obscene', 'score': 2.693259739317e-05}, {'label': 'sexual_explicit', 'score': 1.7653041140874848e-05}, {'label': 'severe_toxicity', 'score': 1.1628764013948967e-06}]], [{'label': 'clean', 'score': 0.9489519596099854}], [{'label': 'SAFE', 'score': 0.9999998807907104}], {'neg': 0.0, 'neu': 0.351, 'pos': 0.649, 'compound': 0.5719}]
'''

def generate_out_metrics(prompt, llm_output):
    out_scanners = [
        output_scanners.Bias(),
        output_scanners.FactualConsistency(),
        output_scanners.Gibberish(),
        output_scanners.Relevance(),
        output_scanners.Sentiment(),
        output_scanners.Toxicity(),
    ]
    sanitized_prompt, results_valid, results_score, results_arr = scan_output(
        out_scanners,
        prompt,
        llm_output
    )
    return sanitized_prompt, results_valid, results_score, results_arr

'''
Ouput of generate_out_metrics("I am a happy person.","That's wonderful to hear! What brings you joy and happiness in your life?")
That's wonderful to hear! What brings you joy and happiness in your life? {'Bias': False, 'FactualConsistency': False, 'Gibberish': True, 'Relevance': True, 'Sentiment': True, 'Toxicity': True} {'Bias': 1.0, 'FactualConsistency': 0.99, 'Gibberish': 0.0, 'Relevance': 0.0, 'Sentiment': 0.0, 'Toxicity': 0.0} [[{'label': 'BIASED', 'score': 0.8551951050758362}], [0.013229156844317913, 0.9867708683013916], [{'label': 'clean', 'score': 0.9748314619064331}], {'prompt_embedding': array([ 4.50680871e-03, -2.69094063e-03,  4.82437722e-02, -6.34770468e-02,
        1.89023111e-02,  4.39116433e-02,  2.61217682e-03,  1.55499680e-02,
       -2.63384602e-04, -1.57358050e-02, -2.24452727e-02, -8.27896316e-03,
       -6.14035828e-03, -1.00845322e-02,  4.68724314e-03,  4.38668812e-03,
        3.60465720e-02, -6.97593065e-03, -2.98062339e-03,  5.77673651e-02,
       -1.13840457e-02,  1.86392050e-02, -2.43014768e-02,  1.29784672e-02,
        6.90558180e-03, -7.06961192e-03,  2.05233227e-02,  5.44411596e-03,
       -5.47636785e-02, -2.91334614e-02,  6.37845173e-02,  1.27193341e-02,
        1.83573496e-02,  2.35891268e-02,  3.15532014e-02, -1.73647664e-02,
        2.86866771e-03,  5.69010060e-03, -2.93615572e-02, -3.74230891e-02,
       -1.19831075e-03, -1.85677130e-02, -1.71113238e-02, -2.87627187e-02,
       -7.97684863e-02, -1.11971302e-02, -1.23553760e-02,  2.20453702e-02,
       -3.93325835e-02,  2.41412129e-03, -1.55575555e-02,  2.01045349e-02,
        7.40686757e-03,  2.64101028e-02,  5.62471710e-02,  5.60877137e-02,
       -3.44126187e-02, -2.50450317e-02, -4.00674455e-02, -1.19033037e-02,
        3.15558910e-02, -1.32994866e-02,  2.86054052e-03, -3.40146273e-02,
        4.58129263e-03,  5.54222539e-02, -2.39864122e-02, -1.42575232e-02,
        3.14406981e-03,  4.06912975e-02,  2.26228219e-02, -3.28162462e-02,
        6.41737692e-03, -4.39717546e-02, -3.95956624e-04, -6.78208619e-02,
        2.00560177e-03, -2.98115890e-02, -6.53285068e-03,  1.08722104e-02,
        5.27392477e-02, -1.88636761e-02,  1.90555281e-03,  6.02951534e-02,
        4.57676537e-02, -1.86904632e-02,  7.16355350e-03,  2.38057063e-03,
       -1.21552479e-02,  6.94265738e-02,  3.85612925e-03,  1.98335126e-02,
        6.59623146e-02,  5.33765629e-02,  1.94545723e-02, -1.86773594e-02,
        6.67790184e-04, -5.21443896e-02,  1.44074229e-03, -2.07639840e-02,
        7.90300686e-03, -3.93957719e-02,  5.27002243e-03, -6.32641762e-02,
       -5.51520288e-02, -3.95998023e-02,  1.17912870e-02,  8.57866742e-03,
        6.00423142e-02,  1.58272106e-02, -2.65319664e-02,  3.91731150e-02,
       -1.98957995e-02,  5.10338508e-02, -2.72303708e-02,  7.29142353e-02,
        4.26723175e-02, -5.60286548e-03, -7.31936703e-03, -3.63376439e-02,
        4.60374206e-02,  3.99046624e-03, -1.56161916e-02,  4.10310552e-02,
       -2.30556447e-02, -3.32546644e-02, -5.88721968e-02,  1.90171078e-02,
       -5.82039822e-03,  3.45025281e-03, -1.29366312e-02,  7.26392195e-02,
       -3.07609867e-02,  1.43577075e-02,  4.03807908e-02, -4.05349769e-02,
        2.45315451e-02, -4.09690589e-02,  4.08010036e-02, -7.53093064e-02,
        2.25820020e-02, -5.16912527e-03, -3.14835906e-02,  1.90046355e-02,
        7.19941407e-02,  2.12395331e-03,  9.41951480e-03,  1.93437207e-02,
        1.10667828e-03,  1.21555524e-02, -2.50695329e-02, -2.21494474e-02,
       -2.42349040e-02, -1.41862333e-02,  2.24740729e-02,  1.80591717e-02,
        1.19021558e-03,  2.93661021e-02,  8.03092204e-04,  2.24461555e-02,
        7.65403127e-03,  8.14975239e-03, -2.52751838e-02, -2.66207755e-02,
       -1.41375916e-04,  4.00777049e-02,  3.99784744e-02,  2.77159810e-02,
       -3.08162831e-02, -1.38047058e-02,  2.64850468e-03, -6.56185225e-02,
        2.67076828e-02,  2.20197942e-02, -4.36545387e-02,  9.41670593e-03,
        1.08884275e-01, -4.95391563e-02,  2.93972716e-02, -4.92697321e-02,
       -5.50226904e-02,  4.18554917e-02, -3.25321890e-02,  4.64916378e-02,
       -5.48320916e-03, -2.36652847e-02,  4.90780047e-04, -2.85127945e-02,
        2.77683511e-02, -7.97769055e-03, -4.00405414e-02, -3.29156853e-02,
        1.48019567e-02, -3.23646702e-02,  2.91238166e-02, -3.51955406e-02,
       -2.48807538e-02,  1.94426044e-03, -1.53205302e-02,  5.58491386e-02,
       -4.19386104e-02,  5.95905595e-02,  4.41019647e-02, -3.76096666e-02,
       -2.76391972e-02,  5.34370728e-02,  5.40528521e-02,  7.67593533e-02,
       -2.63895970e-02, -5.69127034e-03, -1.12089291e-02, -2.61801481e-02,
        6.85619488e-02, -1.62428617e-02, -4.29964401e-02,  7.20988773e-03,
        2.06254050e-02,  1.37931267e-02, -2.56141163e-02,  1.41381044e-02,
        2.46768277e-02,  3.07565778e-02, -5.08754998e-02,  3.15959528e-02,
        7.66644999e-02,  5.35500050e-02, -1.39874930e-03, -7.30478168e-02,
       -9.75931529e-03,  6.12916164e-02, -6.16719313e-02, -3.93938981e-02,
        6.23348076e-03,  6.73962086e-02, -1.89818218e-02,  4.67525348e-02,
        6.59409687e-02, -4.34381999e-02,  4.44791839e-02, -2.14816742e-02,
        9.47134476e-03,  3.74344066e-02,  3.28649394e-02,  2.83100456e-02,
       -6.71517104e-02, -8.57958198e-03, -1.61883142e-03, -5.58851134e-05,
       -4.54540253e-02,  2.65167914e-02, -1.60271500e-03,  2.86872475e-03,
        1.74538624e-02,  9.35232081e-03, -1.14063853e-02, -7.31197670e-02,
        3.44856419e-02,  8.48630723e-03,  1.39647750e-02,  8.18246156e-02,
       -2.99161132e-02, -5.70088662e-02, -1.62613336e-02,  2.96698045e-02,
       -4.76776026e-02, -3.48512568e-02, -3.52257602e-02, -4.04173322e-03,
        1.47119379e-02,  2.83559710e-02, -1.73362941e-02,  1.12126805e-02,
        1.19488481e-02,  1.44544365e-02,  1.43644828e-02, -1.64534766e-02,
        3.92751135e-02,  3.22408415e-02, -3.99969295e-02, -7.53073543e-02,
        1.17418971e-02,  3.49473245e-02, -2.96979491e-02,  1.66037437e-02,
        4.14624773e-02, -9.33862776e-02, -3.87288854e-02, -7.32613087e-04,
       -6.63800538e-02,  1.32883359e-02,  5.96101768e-02,  4.09563221e-02,
        5.39669544e-02, -3.16504203e-03,  6.94279000e-02, -5.65338247e-02,
        4.62501496e-02, -1.20992977e-02, -4.88026720e-03,  7.16417329e-03,
        4.23244014e-02, -5.08291237e-02,  2.30116099e-02,  6.83861738e-03,
        6.71661943e-02, -4.14859876e-02,  2.33930033e-02, -4.95933145e-02,
       -2.38560677e-01,  1.17612267e-02,  4.63788733e-02, -3.18856761e-02,
       -6.70018187e-03, -1.05921011e-02,  3.51676233e-02, -3.69666927e-02,
       -6.01185635e-02,  1.62804294e-02, -9.24927462e-03,  3.18980892e-03,
        2.45880918e-03,  2.50625610e-02,  5.10712862e-02, -3.74281406e-02,
        1.65896397e-03, -9.70951002e-03, -1.59296617e-02,  9.74695757e-03,
       -1.49203581e-03, -5.06948866e-03, -2.30022892e-02, -4.27607307e-03,
        4.78951968e-02, -3.63317281e-02, -4.57743462e-03,  1.16859088e-02,
       -3.37912217e-02, -1.92356599e-03, -1.77792050e-02, -1.77809410e-02,
        3.28583689e-03, -1.85165135e-03,  2.21119821e-02,  3.55808227e-03,
        2.48012338e-02, -5.16075678e-02, -2.63634939e-02, -5.67308953e-03,
        5.30696958e-02, -5.72877042e-02,  2.52435915e-02, -1.22612966e-02,
        4.69168685e-02, -9.93472245e-03, -4.02777195e-02, -5.52779529e-03,
       -6.84062252e-03, -4.51137777e-03,  7.64740352e-03,  1.48217648e-03,
        2.24381611e-02, -2.50949766e-02,  9.83599387e-03,  2.14562397e-02,
        8.81898403e-03, -1.14437854e-02, -4.52506170e-02,  3.19013782e-02,
       -2.98401937e-02,  3.64924483e-02, -1.52192973e-02, -1.00439461e-02,
       -4.15319670e-03, -7.21460767e-03, -4.59672837e-03, -5.44922799e-02,
        5.01974076e-02,  5.31484410e-02,  5.65564483e-02,  1.10971006e-02,
        4.79420228e-03, -5.69485985e-02, -2.78325155e-02, -6.57305913e-03,
       -2.03877259e-02,  1.96740795e-02, -2.16736589e-02,  9.40395147e-03,
       -4.40251641e-02, -2.78057903e-02,  8.29751566e-02,  2.97246408e-02,
       -9.83217638e-03, -7.63435662e-03,  2.05442030e-02,  6.28497824e-02,
       -3.30021069e-03, -1.03964945e-02,  5.84291071e-02, -2.04720870e-02,
       -1.04678832e-02,  1.21103525e-02,  4.49706391e-02, -1.54606551e-02,
       -8.80095176e-03, -2.17513577e-03, -1.14665634e-03, -2.90720016e-02,
        5.63755855e-02,  5.00039523e-03,  4.46858369e-02,  5.61814532e-02,
        1.37546556e-02, -7.25008128e-03, -3.37579399e-02, -1.55669302e-02,
        6.74276799e-02,  2.27877013e-02,  2.44079670e-03, -5.03623113e-03,
        3.13197896e-02, -6.34880513e-02,  6.48659468e-02, -4.77185920e-02,
        4.06706007e-03,  3.74796591e-03, -1.33569110e-02,  4.21022922e-02,
        3.59259360e-02, -1.09759513e-02, -6.03581667e-02,  1.30521124e-02,
       -7.89662525e-02,  5.75409643e-02,  3.34588587e-02,  2.30131159e-03,
       -6.15633838e-02, -2.29243636e-02, -4.17843647e-03, -4.80465814e-02,
       -4.18173196e-03, -9.86513030e-03,  1.25435526e-02,  3.58330156e-03,
       -5.68328090e-02, -5.62914535e-02,  5.86152822e-03, -4.40366939e-02,
       -4.78808470e-02, -1.94706600e-02, -5.02905697e-02,  3.22636217e-02,
       -9.57525894e-03, -9.05686151e-03,  8.40639416e-03, -4.01998498e-02,
       -4.77420464e-02,  2.64976956e-02, -3.34117487e-02,  1.87280506e-03,
       -6.51818812e-02, -8.00079778e-02, -3.04297749e-02,  1.01301763e-02,
        1.44420471e-02,  4.14999435e-03, -1.40186865e-02,  1.48664636e-03,
       -7.07565947e-03, -8.71316940e-02, -2.38826256e-02, -1.21502876e-02,
        3.37417610e-02,  7.03840256e-02, -5.86719885e-02, -1.71352830e-02,
        1.40200974e-03,  7.20592262e-03,  1.87427383e-02, -2.80360002e-02,
       -1.21786213e-03, -2.54628547e-02,  2.22281931e-04,  1.75057855e-02,
        1.05460463e-02,  2.08548992e-03,  5.90083748e-02, -2.37595383e-02,
       -2.52865460e-02, -3.79571803e-02, -3.72247621e-02, -3.63507331e-03,
        8.14221278e-02,  6.84067467e-03,  6.00755727e-03, -4.27071825e-02,
        3.09057981e-02, -7.62717845e-03,  1.04751587e-02,  1.88234765e-02,
       -3.89453024e-02, -1.01512987e-02, -7.07131997e-02, -6.74953386e-02,
        1.89521238e-02, -2.04802714e-02, -2.53367014e-02,  2.64444435e-03,
        2.18199138e-02, -4.28349078e-02, -2.10242067e-02, -1.97812133e-02,
        2.32632924e-02, -6.08107932e-02, -7.11897202e-03,  1.76591296e-02,
        1.51659828e-02,  6.00950234e-02, -3.86344939e-02, -3.01868431e-02,
        2.94692293e-02, -3.08785867e-02, -1.95196271e-02,  9.08945873e-03,
        1.07768271e-02, -3.32136266e-02, -4.84077074e-02, -4.65021394e-02,
        2.55299397e-02, -3.94388549e-02, -2.13965625e-02, -1.60572100e-02,
       -1.28084384e-02,  6.03346201e-03, -7.48701932e-05, -9.29969084e-03,
        4.47143521e-03, -7.78569803e-02,  3.06480136e-02, -5.28869219e-02,
        2.95459647e-02,  7.12017119e-02, -5.01324385e-02, -5.44243418e-02,
       -3.02756522e-02,  8.83843377e-03, -4.96683381e-02, -1.49400113e-02,
        6.09815167e-03,  4.49946150e-03,  8.82402342e-03, -2.61260159e-02,
        6.11247015e-05, -2.18074042e-02, -6.86908374e-03, -9.05410945e-03,
       -1.97082181e-02,  3.47499773e-02, -3.05634607e-02,  2.96044704e-02,
       -3.14565413e-02,  2.16546934e-02,  5.15780896e-02, -5.11275865e-02,
        8.87662359e-03, -8.16969667e-03, -9.83164995e-04, -2.15690560e-03,
        3.28853242e-02,  4.50465158e-02, -4.38052453e-02,  1.32417483e-02,
        3.33247483e-02,  6.80854917e-02,  3.57171311e-03,  4.01519181e-04,
       -1.91698447e-02, -3.04187145e-02, -1.39504066e-02, -1.29020056e-02,
       -6.39649704e-02, -5.05783875e-03,  1.94501653e-02, -1.83770563e-02,
       -6.20633103e-02,  1.22190248e-02,  3.98676135e-02, -8.38105753e-02,
        6.84276596e-02,  3.22828279e-03,  2.34777238e-02,  1.90097038e-02,
       -1.28499949e-02, -2.05216110e-02,  1.60396080e-02, -2.34665684e-02,
       -5.16292602e-02,  1.62183288e-02,  5.12617780e-03,  3.47217582e-02,
       -1.67003809e-03,  4.14924659e-02,  2.79342644e-02,  1.56038264e-02,
        2.79287249e-02,  9.85441878e-02, -6.04353100e-02,  3.33251618e-02,
       -1.55023150e-02,  4.45461050e-02,  4.31032516e-02,  1.37385484e-02,
       -2.53577270e-02,  1.47159267e-02, -4.76857089e-03, -4.65041399e-02,
       -6.32064193e-02,  4.61010598e-02,  1.59739591e-02, -8.18546638e-02,
        6.53654560e-02,  1.14762653e-02, -3.78020816e-02, -6.94547668e-02,
        2.22315663e-03, -3.04124784e-02, -5.53897358e-02,  3.66931632e-02,
        5.70866913e-02, -1.50656886e-02,  1.59749072e-02,  2.38384884e-02,
        4.61338609e-02,  1.71330459e-02, -1.29349371e-02,  4.56193946e-02,
        2.82952394e-02,  3.21853235e-02,  1.78823248e-02,  4.30405512e-02,
        4.34725657e-02,  8.09343383e-02, -7.89712463e-03, -1.27837975e-02,
        4.39401083e-02,  2.17143856e-02, -3.41944955e-02,  5.21480106e-02,
       -4.57624905e-02, -3.04694343e-02, -1.08549632e-02,  7.46471882e-02,
        1.25937117e-02, -1.25488518e-02, -9.31187347e-03,  7.30658621e-02,
        6.13729842e-02, -1.22982888e-02, -9.80732613e-04,  2.66320705e-02,
        1.60963926e-02, -3.98449712e-02,  2.87692938e-02, -3.37593146e-02,
       -2.97470968e-02, -4.01089862e-02, -6.71645179e-02,  2.63869260e-02,
        2.98829544e-02, -1.99086475e-03,  6.46671578e-02, -4.32483852e-02,
        1.34290168e-02, -1.63353439e-02,  8.32969497e-04,  2.56125759e-02,
       -3.43481749e-02, -2.12298264e-03,  1.19686276e-02,  1.95204969e-02,
       -2.01779213e-02,  8.01365152e-02,  1.32225463e-02, -1.89548626e-03,
       -5.96440956e-02, -2.39446145e-02, -4.68592942e-02,  6.66833073e-02,
       -1.17986817e-02,  9.02972370e-03,  1.27407035e-03, -1.87651976e-03,
       -8.27606954e-03, -5.12783863e-02, -2.35405732e-02, -1.60803162e-02,
       -2.51968931e-02, -1.80161241e-02,  4.72194664e-02, -3.08687054e-02,
        3.36918794e-02, -1.37147624e-02, -2.51375269e-02, -1.02016358e-02,
        4.29725796e-02,  5.53680658e-02,  1.43571524e-02,  3.20651643e-02,
        5.71723208e-02,  6.53757229e-02, -1.83977876e-02,  5.42991050e-03,
       -1.91100519e-02,  1.34355295e-02,  1.63827371e-02, -5.67065477e-02,
       -4.60204296e-02, -1.45264054e-02,  3.00229173e-02,  7.21179228e-03,
       -4.23429608e-02,  9.24897753e-03, -5.94472745e-04,  7.66513636e-03,
        7.21976161e-03,  3.69498320e-02, -2.44493270e-03, -7.74954185e-02,
       -3.08123101e-02, -2.85249352e-02,  2.09078938e-02,  5.40283285e-02,
       -3.63972224e-02,  6.80056065e-02, -5.70289083e-02,  3.98140913e-03,
       -4.89238575e-02,  2.88270768e-02,  9.47132707e-03, -5.51814213e-03,
        1.59655674e-03,  1.66885648e-02, -1.52410343e-02, -7.97482878e-02,
        5.08147664e-03, -5.54031273e-03, -4.70541790e-02, -4.63369936e-02,
        4.88826400e-03, -5.21714538e-02,  3.76430340e-02,  8.08704086e-03,
       -3.83291095e-02,  2.37527601e-02, -7.07792491e-03, -1.92079507e-02,
       -8.19710046e-02, -4.42097560e-02,  2.21793242e-02,  4.02119150e-03,
        4.16819602e-02, -1.57478899e-02,  2.66233161e-02, -1.34451929e-02,
       -1.63978292e-03,  2.33798604e-02,  4.84215058e-02,  3.19282301e-02],
      dtype=float32), 'output_embedding': array([ 1.10139616e-03,  2.61984058e-02,  7.27147609e-02, -3.15314648e-03,
        3.11276466e-02,  3.86683084e-02,  1.85455084e-02,  3.58463489e-02,
       -3.09803188e-02, -3.25366035e-02, -2.66514737e-02, -1.73041783e-02,
       -2.45644897e-02,  6.80952612e-03,  1.14544909e-02,  2.98239142e-02,
        4.89015020e-02,  5.86030968e-02,  4.09621336e-02,  5.73283099e-02,
       -7.48135208e-04,  4.59477269e-05, -4.85540703e-02,  2.84142848e-02,
        1.93523988e-02,  1.31322788e-02,  6.60115434e-03, -1.57550815e-02,
       -4.51240838e-02, -3.91259901e-02,  9.41132102e-03,  3.39950137e-02,
        3.62970904e-02, -2.97463648e-02, -6.96333405e-03,  6.13151537e-03,
       -4.85394662e-03, -7.11194298e-04, -1.89686492e-02, -2.71871826e-03,
       -1.65697876e-02, -7.24997297e-02, -3.64497700e-03, -2.46676300e-02,
       -7.01901242e-02, -4.29502167e-02, -4.59939148e-03,  2.31675971e-02,
       -4.53584120e-02,  2.38024276e-02,  4.20316383e-02,  5.65190539e-02,
        6.16519563e-02,  6.23743655e-03,  1.14212349e-01,  6.08320497e-02,
        5.13662864e-03,  1.13665767e-03,  6.89900853e-03, -3.78890075e-02,
       -1.06486846e-02,  5.61778760e-03, -2.31818836e-02,  8.23618658e-03,
        2.54597683e-02,  1.59038662e-03, -4.50227670e-02,  5.26190549e-03,
        9.77724511e-03,  1.46621242e-02,  2.03412287e-02,  1.81863247e-03,
        1.01164207e-02, -3.09564695e-02, -6.94184750e-03, -5.09009436e-02,
       -1.84629243e-02, -1.82363857e-02, -7.50609208e-04,  4.66666445e-02,
        1.41718686e-02, -3.17313075e-02,  5.20421863e-02,  5.21261245e-02,
        5.72711937e-02, -5.35314903e-02,  3.14279459e-02,  1.58196501e-02,
       -2.85493899e-02,  3.94784324e-02, -2.74286512e-03, -2.77585257e-02,
        3.70111093e-02,  3.07259448e-02,  1.58176757e-02, -3.22024412e-02,
       -9.18519218e-03, -1.33378748e-02, -7.19700903e-02,  1.05503751e-02,
       -3.13775018e-02, -2.77001653e-02, -1.42286597e-02, -4.70018573e-02,
       -6.83405846e-02, -1.21810206e-06,  2.51350999e-02, -5.73237576e-02,
        6.90759495e-02,  2.31006984e-02, -4.81023230e-02, -2.94254962e-02,
       -3.34835798e-02,  5.71599370e-03, -1.45759434e-02,  1.18036633e-02,
        3.74916270e-02, -2.63303742e-02, -4.42113057e-02, -6.03662916e-02,
        4.67578210e-02, -1.91840604e-02,  1.33696832e-02,  5.26099242e-02,
        3.18257953e-03, -2.27508899e-02, -3.60208303e-02,  2.48785932e-02,
        2.81965174e-02, -3.78633402e-02,  3.26819830e-02,  3.07925083e-02,
       -2.51142047e-02, -3.05099785e-02,  3.91801484e-02, -4.27588262e-02,
        5.10703772e-02, -2.55340915e-02,  3.88322994e-02,  6.99434197e-03,
       -4.04912699e-03,  1.64182056e-02, -6.03708811e-03, -2.56879088e-02,
        4.76567149e-02, -2.22078338e-02, -4.80851196e-02, -1.06255589e-02,
       -1.76402908e-02, -1.27258999e-02,  3.80860902e-02,  6.10382408e-02,
       -3.25437896e-02, -1.72543582e-02,  1.41858859e-02,  1.30200479e-02,
        4.28906716e-02,  2.94178668e-02, -1.19441887e-02,  4.36173193e-02,
        1.36479950e-02,  1.02853635e-02, -2.38219462e-02,  3.96524416e-03,
       -8.78631044e-03,  2.41380092e-02,  2.00794470e-02,  1.90802682e-02,
       -7.48456120e-02, -2.23242100e-02, -4.98310030e-02, -2.50380975e-03,
        4.30472344e-02, -2.97690392e-03, -7.58220404e-02, -1.29041635e-02,
        1.30246490e-01, -2.04698499e-02, -3.21706533e-02,  6.41299039e-03,
       -4.67917882e-02,  3.53838801e-02, -5.12652434e-02, -4.81488323e-03,
       -2.01414321e-02,  8.72719451e-04,  3.38826841e-03,  2.19473783e-02,
        3.36345173e-02,  2.43611149e-02, -3.67446020e-02, -3.68127190e-02,
       -9.87731852e-03,  1.00889141e-02,  2.27359161e-02, -4.60111611e-02,
       -2.91708168e-02,  6.34397054e-03,  2.15410516e-02,  2.11097207e-02,
       -2.57790391e-03,  4.43677232e-02, -1.13932947e-02, -3.98602821e-02,
       -1.48266554e-03,  4.37714309e-02,  5.71058458e-03,  2.15254538e-02,
       -1.55972419e-02, -1.24500934e-02, -2.16480829e-02, -3.29354592e-02,
        5.24365306e-02, -2.19909586e-02, -3.86852920e-02, -5.14665153e-03,
        2.24840902e-02, -4.04328555e-02, -2.86487248e-02,  2.34169457e-02,
        5.17086685e-03,  8.15502740e-03, -8.10386240e-03,  2.00720932e-02,
        7.33987764e-02,  5.52725531e-02, -9.62324254e-03, -3.52725051e-02,
       -6.28901972e-03,  7.94500634e-02, -1.69629902e-02, -3.31426188e-02,
        4.33160216e-02,  1.63609423e-02,  1.22627700e-02,  4.78500575e-02,
        5.23318090e-02, -1.64351128e-02,  7.63512850e-02, -2.83040944e-03,
       -4.72698957e-02,  2.90351976e-02, -6.60967838e-04,  1.46375969e-02,
       -4.25272658e-02,  2.30306736e-03,  1.83098204e-02, -4.98069776e-03,
       -2.61622444e-02, -5.14455326e-03,  1.20374933e-02, -1.40111865e-02,
        1.00636585e-02,  4.55479622e-02, -1.86717901e-02, -6.76242933e-02,
        1.78307146e-02, -8.83491337e-03,  4.23115604e-02,  4.40731570e-02,
       -3.32399122e-02,  6.18419098e-03,  6.29881620e-02, -4.95247450e-03,
       -6.99563920e-02, -1.45513071e-02, -8.29264987e-03, -1.12099526e-02,
        2.18954235e-02,  2.13804431e-02,  1.50167178e-02,  4.32934649e-02,
        2.02031597e-03,  1.75104234e-02, -1.03679895e-02, -1.01803243e-02,
        4.10520136e-02,  2.87916302e-03, -1.50182359e-02, -6.50205538e-02,
       -4.79819179e-02,  5.14210910e-02, -2.91708596e-02,  3.56859863e-02,
       -1.39925247e-02, -5.97140156e-02, -5.40622463e-03, -6.18450018e-03,
       -1.69086643e-02, -7.45709334e-03,  4.55406830e-02,  1.62556267e-03,
        6.70294315e-02,  1.89256668e-02,  6.10432364e-02, -1.49212610e-02,
        7.39000738e-02, -8.32144916e-03, -1.53823644e-02,  4.27008793e-02,
        5.97479828e-02, -6.83611184e-02,  3.91173102e-02, -1.69285145e-02,
        7.28293061e-02,  5.75893326e-03,  2.02969052e-02, -5.50992154e-02,
       -2.13331714e-01, -3.58640705e-03,  1.20946439e-02, -5.15525565e-02,
        8.29622429e-03, -4.89828959e-02,  3.18698324e-02, -1.35870297e-02,
       -4.68314104e-02,  3.13818902e-02, -1.73229687e-02, -4.05423231e-02,
       -7.35476497e-04,  2.71476060e-02,  3.40684801e-02, -1.50934281e-02,
        1.81743484e-02, -1.62714068e-02,  1.79882143e-02,  2.28894316e-02,
       -2.86433045e-02, -3.00630257e-02, -3.04524023e-02,  4.61247899e-02,
        9.88484640e-03,  7.05403509e-03, -9.20413341e-03,  8.75530578e-03,
       -1.07122988e-01,  1.60598215e-02, -1.95034947e-02,  9.89124179e-04,
        7.56916450e-03, -1.64702442e-02,  2.83910036e-02,  1.98654272e-02,
        4.40300703e-02, -1.06525654e-02,  4.70106723e-03, -2.41401270e-02,
        2.93304808e-02, -6.95841983e-02,  5.99161498e-02, -9.55519266e-03,
        2.69663874e-02, -2.25690310e-03, -3.75439599e-02,  8.36440013e-05,
       -5.16833588e-02,  3.90733667e-02, -1.52906869e-03, -2.17658188e-02,
       -1.55993905e-02,  6.56173145e-03,  2.74075586e-02,  2.99153812e-02,
        1.21422308e-02, -4.58892919e-02, -2.16475073e-02, -3.66763119e-03,
       -3.26577388e-03,  5.88305891e-02, -6.00107238e-02, -2.17923336e-02,
       -1.46198003e-02, -1.60114821e-02, -6.25414401e-02, -4.93766703e-02,
        3.91186327e-02, -1.49684923e-03,  1.81297380e-02,  3.62986419e-03,
        2.12576357e-03, -6.79032430e-02, -4.06056345e-02, -8.73928331e-03,
       -6.12204857e-02,  8.66542477e-03, -4.54931669e-02,  2.75666621e-02,
       -6.30054325e-02, -4.37385812e-02,  6.62572756e-02,  5.32178581e-02,
        1.69088412e-02, -2.26147231e-02,  1.70978624e-02, -9.56427213e-03,
       -7.22909197e-02,  3.82251758e-03,  5.64535297e-02, -6.04990534e-02,
       -1.00938547e-02,  8.13533552e-03,  4.76620495e-02,  6.44963309e-02,
       -3.61350775e-02,  1.61403368e-04, -1.70858193e-03, -3.45775411e-02,
        5.32820672e-02,  2.86744966e-04, -2.07935786e-03,  2.52117347e-02,
        2.15296783e-02, -5.51703200e-03, -4.45620269e-02, -2.76555810e-02,
        8.74162838e-02,  4.84211603e-03, -2.39827856e-02,  2.63863169e-02,
        2.33808104e-02, -4.17940393e-02,  4.86006960e-02, -7.24704713e-02,
        2.25872616e-04,  5.75093031e-02,  3.25508136e-03,  5.00673577e-02,
        1.65529810e-02, -1.17158955e-02, -5.54772429e-02,  2.15230677e-02,
       -7.02744126e-02,  4.67317998e-02, -1.69968121e-02,  2.36268416e-02,
       -4.56193313e-02, -2.66518183e-02,  4.91177756e-03, -3.68171223e-02,
        8.15593638e-03, -9.58740897e-03, -2.52514798e-02,  2.47342326e-02,
       -2.41863988e-02, -6.08936697e-02, -2.84898784e-02, -4.64696810e-02,
       -1.63071211e-02, -6.89768186e-03, -9.64339599e-02,  3.27604897e-02,
       -5.99714369e-03,  2.99106017e-02, -2.69762538e-02,  3.45775820e-02,
        4.77075344e-03, -5.30896522e-02,  3.78188823e-04, -7.65992701e-03,
       -3.33892480e-02, -6.51051477e-02, -3.72094028e-02, -1.84696335e-02,
        2.10682061e-02, -1.61711138e-03,  4.18576524e-02, -4.08449844e-02,
       -3.04978509e-02, -5.72228506e-02, -5.37111685e-02,  7.17228353e-02,
        6.88376511e-03,  7.75121823e-02, -1.58515312e-02, -6.17258511e-02,
        2.57843547e-03,  1.13696465e-02,  6.30656779e-02,  2.78040916e-02,
       -6.97769970e-03, -3.15588787e-02, -2.06815563e-02,  9.92798060e-03,
       -1.65976677e-02,  6.58523524e-03,  1.34609425e-02, -2.31984388e-02,
        3.12313773e-02, -3.41749527e-02, -3.42063569e-02,  1.71120446e-02,
        2.76214574e-02,  3.75279412e-03,  5.60743250e-02, -3.92734818e-02,
        6.08719885e-02, -2.23941002e-02, -1.54308230e-02,  4.72084880e-02,
       -3.05553582e-02,  1.01314569e-02, -5.05340397e-02, -4.76023182e-02,
        4.23083790e-02, -2.73933262e-02, -4.38529858e-03, -1.67093370e-02,
       -1.62169915e-02, -1.53939929e-02, -1.35390097e-02,  2.51562670e-02,
        6.29559383e-02, -6.05090782e-02,  4.17814404e-02,  4.36783955e-02,
       -1.65302549e-02,  5.85128441e-02, -2.34663319e-02, -2.40395442e-02,
       -1.33760795e-02,  2.80618668e-03, -1.36476895e-02, -2.47351639e-03,
        7.83520192e-03, -3.07642315e-02, -2.90920753e-02,  1.11834402e-03,
       -2.10404322e-02, -2.40146052e-02,  4.78608944e-02, -2.72291843e-02,
       -3.51560973e-02,  1.49880508e-02, -2.08256841e-02, -5.25259711e-02,
        3.11506316e-02, -7.41002858e-02,  3.78957465e-02, -2.10475177e-02,
       -7.01420102e-03,  2.66156578e-03, -4.74513732e-02, -2.84396242e-02,
       -4.87992205e-02,  4.47324710e-03, -4.51759137e-02, -1.14008207e-02,
       -2.15404034e-02,  1.31024644e-02, -1.05604129e-02, -3.31440084e-02,
       -1.06668947e-02,  1.19129885e-02, -2.73035057e-02, -2.39522196e-02,
       -2.48489454e-02,  2.47988943e-02, -2.44169049e-02,  2.11326964e-02,
       -2.58578896e-03, -1.72650311e-02,  1.69430766e-02, -4.99401167e-02,
       -5.05955778e-02,  2.16838960e-02, -1.76611133e-02, -2.70048305e-02,
        3.81340012e-02,  2.13906895e-02, -8.95594880e-02, -2.80930903e-02,
        4.86972332e-02,  2.24451814e-02,  1.99935026e-02,  3.63544631e-03,
       -6.15287456e-04, -7.56962691e-03, -1.74302775e-02, -2.81981695e-02,
       -3.85210142e-02,  7.80026382e-03,  1.66998710e-02, -5.68106063e-02,
       -2.70277411e-02,  4.39515077e-02,  4.54156511e-02, -1.10013060e-01,
        2.22769976e-02,  4.06846106e-02,  6.33238000e-04, -3.00951079e-02,
       -9.58940305e-04, -9.52727646e-02,  8.15312564e-03, -2.02931054e-02,
       -1.63943544e-02,  8.48430917e-02, -2.82681528e-02,  9.99433361e-03,
        2.21734736e-02,  2.87069809e-02,  1.24156068e-03,  8.65295343e-03,
        4.99197394e-02,  4.12105583e-02, -3.48311476e-02,  1.07081151e-02,
        6.35734666e-03,  7.52150267e-03,  7.54290000e-02,  2.42935512e-02,
       -1.91920344e-02,  1.45522319e-02, -3.38381231e-02, -3.39612328e-02,
       -1.76369380e-02,  5.63578866e-02,  6.99387789e-02, -4.92457934e-02,
        4.60413322e-02,  2.94576809e-02, -3.71527560e-02, -1.48323011e-02,
        2.47323085e-02, -8.49737879e-03, -2.06557848e-02,  1.77799053e-02,
        1.63323134e-02, -2.96310373e-02,  4.59833853e-02,  1.40391728e-02,
        5.29035851e-02,  1.91727914e-02, -1.56747270e-02, -1.06866872e-02,
        1.06197158e-02,  7.43639320e-02,  4.42155786e-02,  5.90000413e-02,
        6.09298050e-03,  5.74401170e-02,  1.70960389e-02, -3.76770832e-02,
        1.37392730e-02,  1.96298156e-02,  1.50339128e-02,  4.84329499e-02,
       -7.39813177e-03,  6.20300788e-03,  2.49630194e-02,  9.96006951e-02,
        5.29799610e-02,  2.16876343e-02, -1.31918611e-02,  3.23543102e-02,
        7.31885731e-02, -3.21817361e-02,  2.42284071e-02,  7.24323513e-03,
        4.98832483e-03, -3.86208035e-02,  4.36765999e-02, -2.79084649e-02,
        4.45167534e-02, -1.44889681e-02,  8.66120681e-03,  4.23848489e-03,
        3.09536271e-02, -4.64786636e-03,  4.57089059e-02, -8.93317722e-03,
        4.44219001e-02, -1.66065376e-02,  2.93709282e-02, -8.97386856e-03,
        2.60758549e-02,  3.19581367e-02, -3.13134454e-02,  2.33140904e-02,
       -1.88914221e-02, -1.19400900e-02,  1.54636474e-02, -1.34575786e-02,
       -2.65329443e-02, -4.76760976e-02,  6.26595924e-03,  3.91063467e-02,
        1.34149417e-02,  3.51764448e-02, -4.57780287e-02, -4.35010530e-02,
       -1.32540483e-02, -4.84189391e-02, -4.42865826e-02, -3.43311690e-02,
       -2.21525542e-02, -5.89392893e-02,  3.52302194e-02,  3.14761861e-03,
        2.31629126e-02,  8.01480841e-03, -1.75424777e-02, -2.26699598e-02,
        8.12769085e-02,  5.39191067e-02, -1.26784137e-02,  2.01155692e-02,
        5.99964485e-02,  5.92291281e-02,  5.12622483e-03, -2.44555417e-02,
       -5.49300648e-02,  1.22054163e-02, -7.23815570e-03, -3.89709473e-02,
       -7.68150985e-02, -4.01088968e-03,  2.93121263e-02, -1.79035850e-02,
       -6.14301525e-02, -9.66308918e-03,  2.16274001e-02, -2.09730794e-03,
        5.27605005e-02,  2.61451434e-02,  9.99446772e-03, -6.06150292e-02,
       -1.45726223e-02, -2.78093368e-02, -1.41462665e-02,  3.09971217e-02,
        6.39344240e-03,  6.81796670e-02, -2.77100578e-02,  3.95968705e-02,
       -6.07726276e-02,  1.39318993e-02,  2.52393186e-02,  7.08868122e-03,
       -3.17956172e-02,  5.08451136e-03,  1.02660824e-02, -4.32145521e-02,
       -2.55642105e-02, -1.58178639e-02, -2.61247195e-02, -3.02297790e-02,
       -1.49122588e-02, -3.38057056e-02, -2.78790924e-03,  2.15928853e-02,
       -6.07722662e-02,  1.16345668e-02, -6.17728801e-03, -4.27871868e-02,
       -4.62419093e-02, -4.68366742e-02,  1.28417034e-02, -5.69082275e-02,
        2.49789245e-02, -2.96997800e-02,  3.24407220e-02, -1.63406059e-02,
        6.62183529e-03,  1.42830042e-02,  6.05514795e-02, -2.68109459e-02],
      dtype=float32)}, {'neg': 0.0, 'neu': 0.467, 'pos': 0.533, 'compound': 0.908}, [[{'label': 'toxicity', 'score': 0.00037748011527583003}, {'label': 'male', 'score': 0.00017676602874416858}, {'label': 'female', 'score': 0.00012576095468830317}, {'label': 'insult', 'score': 0.00011327293032081798}, {'label': 'christian', 'score': 0.00010825065692188218}, {'label': 'psychiatric_or_mental_illness', 'score': 9.590384433977306e-05}, {'label': 'muslim', 'score': 5.3658339311368763e-05}, {'label': 'white', 'score': 5.181708911550231e-05}, {'label': 'black', 'score': 3.348649988765828e-05}, {'label': 'threat', 'score': 2.8549289709189907e-05}, {'label': 'homosexual_gay_or_lesbian', 'score': 2.7501784643391147e-05}, {'label': 'jewish', 'score': 2.6812816940946504e-05}, {'label': 'identity_attack', 'score': 2.5784285753616132e-05}, {'label': 'obscene', 'score': 2.505722841306124e-05}, {'label': 'sexual_explicit', 'score': 1.9144814359606244e-05}, {'label': 'severe_toxicity', 'score': 1.0939185131064733e-06}]]]
'''

if __name__=="__main__":
    sanitized_prompt, results_valid, results_score, results_arr = generate_out_metrics("I am a happy person.","That's wonderful to hear! What brings you joy and happiness in your life?")
    print(sanitized_prompt, results_valid, results_score, results_arr)